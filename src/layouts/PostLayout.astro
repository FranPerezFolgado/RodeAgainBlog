---
import "../styles/global.css";
import OptimizedPicture from "@components/OptimizedPicture.astro";
import BaseLayout from "./BaseLayout.astro";
import { getAlbumImages } from "@utils/photos";
import PostGallery from "@components/PostGallery.astro";
import { Image } from "astro:assets";
import Referral from "@components/Referral.astro";

const {
  title,
  description,
  cover,
  pubDate,
  tags,
  postAlbum,
  referralLink,
  referralImage,
  referralDescription,
  referralTitle,
} = Astro.props;
const postAlbumPromise = getAlbumImages(postAlbum);
const images = await postAlbumPromise;
---

<BaseLayout class="absolute z-20">
  <div class="relative h-screen w-screen max-w-full">
    <div class="absolute bottom-0 left-0 right-0 top-0 z-0 overflow-hidden">
      <Image
        src={cover}
        alt={title}
        format="avif"
        quality={80}
        loading={"eager"}
        class="h-full w-full object-cover transition-all duration-300 ease-in-out"
      />
    </div>
    <div
      class="absolute bottom-0 left-0 right-0 top-0 z-0 bg-black bg-opacity-50"
    >
    </div>
    <div
      class="absolute bottom-0 left-0 right-0 top-0 z-10 flex flex-col items-center justify-center"
    >
      <h1
        class="max-w-6xl text-center text-3xl font-bold text-white drop-shadow-sm md:text-4xl lg:text-5xl xl:text-7xl"
      >
        {title}
      </h1>
    </div>
  </div>
  <div class="flex-grow">
    <slot />
  </div>
  <PostGallery images={images} postAlbum={postAlbum} title={title} />
  <Referral url={referralLink} text={referralTitle} description={referralDescription} imageurl={referralImage}/>
</BaseLayout>
